<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Webhdfs by thomasvincent</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Webhdfs</h1>
      <h2 class="project-tagline">Ruby client for Hadoop WebHDFS</h2>
      <a href="https://github.com/thomasvincent/webhdfs" class="btn">View on GitHub</a>
      <a href="https://github.com/thomasvincent/webhdfs/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/thomasvincent/webhdfs/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="refactored-webhdfs---a-client-library-implementation-for-hadoop-webhdfs-and-httpfs-for-ruby" class="anchor" href="#refactored-webhdfs---a-client-library-implementation-for-hadoop-webhdfs-and-httpfs-for-ruby" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Refactored webhdfs - A client library implementation for Hadoop WebHDFS, and HttpFs, for Ruby</h2>

<p>The webhdfs gem is to access Hadoop WebHDFS (EXPERIMENTAL: and HttpFs). WebHDFS::Client is a client class, and WebHDFS::FileUtils is utility like 'fileutils'. </p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h2>

<pre><code>gem install webhdfs
</code></pre>

<h2>
<a id="difference-between-webhdfs-and-httpfs" class="anchor" href="#difference-between-webhdfs-and-httpfs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Difference between WebHDFS and httpfs</h2>

<p><a href="https://www.linkedin.com/today/post/article/20140717115238-176301000-accessing-hdfs-using-the-webhdfs-rest-api-vs-httpfs">https://www.linkedin.com/today/post/article/20140717115238-176301000-accessing-hdfs-using-the-webhdfs-rest-api-vs-httpfs</a></p>

<p>WebHDFS vs HttpFs Major difference between WebHDFS and HttpFs: WebHDFS needs access to all nodes of the cluster and when some data is read it is transmitted from that node directly, whereas in HttpFs, a singe node will act similar to a "gateway" and will be a single point of data transfer to the client node. So, HttpFs could be choked during a large file transfer but the good thing is that we are minimizing the footprint required to access HDFS.</p>

<h2>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Usage</h2>

<h3>
<a id="webhdfsclient" class="anchor" href="#webhdfsclient" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>WebHDFS::Client</h3>

<p>For client object interface:</p>

<pre><code>require 'webhdfs'
client = WebHDFS::Client.new(hostname, port)
# or with pseudo username authentication
client = WebHDFS::Client.new(hostname, port, username)
</code></pre>

<p>To create/append/read files:</p>

<pre><code>client.create('/path/to/file', data)
client.create('/path/to/file', data, :overwrite =&gt; false, :blocksize =&gt; 268435456, :replication =&gt; 5, :permission =&gt; '0666')

#This does not require whole data in memory, and it can be read chunk by chunk, ex: File data
client.create('/path/to/file', file_IO_handle, :overwrite =&gt; false, :permission =&gt; 0666)

client.append('/path/to/existing/file', data)

client.read('/path/to/target') #=&gt; data
client.read('/path/to/target' :offset =&gt; 2048, :length =&gt; 1024) #=&gt; data
</code></pre>

<p>To mkdir/rename/delete directories or files:</p>

<pre><code>client.mkdir('/hdfs/dirname')
client.mkdir('/hdfs/dirname', :permission =&gt; '0777')

client.rename(original_path, dst_path)

client.delete(path)
client.delete(dir_path, :recursive =&gt; true)
</code></pre>

<p>To get status or list of files and directories:</p>

<pre><code>client.stat(file_path) #=&gt; key-value pairs for file status
client.list(dir_path)  #=&gt; list of key-value pairs for files in dir_path
</code></pre>

<p>And, 'content_summary', 'checksum', 'homedir', 'chmod', 'chown', 'replication' and 'touch' methods available.</p>

<p>For known errors, automated retries are available. Set <code>retry_known_errors</code> option as true.</p>

<pre><code>#### To retry for LeaseExpiredException automatically
client.retry_known_errors = true

# client.retry_interval = 1 # [sec], default: 1
# client.retry_times = 1 # [times], default: 1
</code></pre>

<h3>
<a id="webhdfsfileutils" class="anchor" href="#webhdfsfileutils" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>WebHDFS::FileUtils</h3>

<pre><code>require 'webhdfs/fileutils'
WebHDFS::FileUtils.set_server(host, port)
# or
WebHDFS::FileUtils.set_server(host, port, username, doas)

WebHDFS::FileUtils.copy_from_local(localpath, hdfspath)
WebHDFS::FileUtils.copy_to_local(hdfspath, localpath)

WebHDFS::FileUtils.append(path, data)
</code></pre>

<h3>
<a id="for-httpfs" class="anchor" href="#for-httpfs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For HttpFs</h3>

<p>For HttpFs instead of WebHDFS:</p>

<pre><code>client = WebHDFS::Client.new('hostname', 14000)
client.httpfs_mode = true

client.read(path) #=&gt; data

# or with webhdfs/filetuils
WebHDFS::FileUtils.set_server('hostname', 14000)
WebHDFS::FileUtils.set_httpfs_mode
WebHDFS::FileUtils.copy_to_local(remote_path, local_path)
</code></pre>

<h3>
<a id="for-http-proxy-servers" class="anchor" href="#for-http-proxy-servers" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For HTTP Proxy servers</h3>

<pre><code>client = WebHDFS::Client.new('hostname', 14000, 'proxy.server.local', 8080)
client.proxy_user = 'jack'   # if needed
client.proxy_pass = 'secret' # if needed
</code></pre>

<h3>
<a id="for-ssl" class="anchor" href="#for-ssl" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For SSL</h3>

<p>Note that net/https and openssl libraries must be available:</p>

<pre><code>client = WebHDFS::Client.new('hostname', 4443)
client.ssl = true
client.ssl_ca_file = "/path/to/ca_file.pem" # if needed
client.ssl_varify_mode = :peer # if needed (:none or :peer)
client.ssl_version = :TLSv1 # if needed
</code></pre>

<h3>
<a id="for-kerberos-authentication" class="anchor" href="#for-kerberos-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For Kerberos Authentication</h3>

<p>Note that <a href="https://github.com/zenchild/gssapi">gssapi</a> library must be available:</p>

<pre><code>client = WebHDFS::Client.new('hostname', 14000)
client.kerberos = true
client.kerberos_keytab = "/path/to/project.keytab"
</code></pre>

<h3>
<a id="for-ssl-client-authentication" class="anchor" href="#for-ssl-client-authentication" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>For SSL Client Authentication</h3>

<p>Note that openssl libraries must be available:</p>

<pre><code>require 'openssl'

client = WebHDFS::Client.new(host, port)
client.ssl = true
client.ssl_key = OpenSSL::PKey::RSA.new(open('/path/to/key.pem'))
client.ssl_cert = OpenSSL::X509::Certificate.new(open('/path/to/cert.pem'))
</code></pre>

<h2>
<a id="authors" class="anchor" href="#authors" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>AUTHORS</h2>

<p>Original Authors:</p>

<ul>
<li>Kazuki Ohta <a href="mailto:kazuki.ohta@gmail.com">kazuki.ohta@gmail.com</a>
</li>
<li>TAGOMORI Satoshi <a href="mailto:tagomoris@gmail.com">tagomoris@gmail.com</a>
</li>
<li>Refactoring done by Thomas Vincent <a href="mailto:thomasvincent@gmail.com">thomasvincent@gmail.com</a>
</li>
</ul>

<h2>
<a id="license" class="anchor" href="#license" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>LICENSE</h2>

<ul>
<li>Copyright: Copyright (c) 2016- Thomas Vincent</li>
<li>Copyright: Copyright (c) 2012- Fluentd Project</li>
<li>License: Apache License, Version 2.0</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/thomasvincent/webhdfs">Webhdfs</a> is maintained by <a href="https://github.com/thomasvincent">thomasvincent</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-43706788-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
